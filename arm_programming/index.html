
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nus-ee4218.github.io/labs/arm_programming/">
      
      
        <link rel="prev" href="../arm_memmap/">
      
      
        <link rel="next" href="../getting_started/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>ARM Programming Guide - CG3207 Labs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#arm-programming-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CG3207 Labs" class="md-header__button md-logo" aria-label="CG3207 Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CG3207 Labs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ARM Programming Guide
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CG3207 Labs" class="md-nav__button md-logo" aria-label="CG3207 Labs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CG3207 Labs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CG3207 Lab Manuals
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LICENSE
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../arm_memmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARM Memory Map
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ARM Programming Guide
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ARM Programming Guide
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-project-and-basic-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Project and Basic Settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Instructions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging Instructions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-hex-to-rom-initialization-code" class="md-nav__link">
    <span class="md-ellipsis">
      Converting .hex to ROM Initialization Code
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started with Vivado and HDL
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rv_memmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RISC-V Memory Map
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rv_programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RISC-V Programming
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../uart_realterm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UART and RealTerm
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lab1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Lab1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab1/lab1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 1: Familiarisation with Assembly Language and HDL/FPGA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lab2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Lab2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab2/Template_Updates_Log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Work in progress - Cleanup Necessary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab2/lab2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 2: Implementation of a RISC-V 32-bit (RV32I) Processor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab2/lab2_schedule/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab2 schedule
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lab3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Lab3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab3/lab3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 3: Multiplication / Division units
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lab4
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Lab4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab4/Using_Compiled_Code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4: Using Compiled Code and New Peripherals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab4/additional_instructions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 Enhancement: Implementing additional instructions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab4/hazard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 Enhancement: Resolving Hazards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab4/interrupts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4 Enhancement: Interrupt generation and exception handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab4/lab4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4: (Near) Complete Processor + Pipelining + Bells + Whistles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab4/pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab 4: Implementing Pipelining
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vivado install guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Vivado install guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vivado_install_guide/vivado_install_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation Guide for Vivado
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-project-and-basic-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a Project and Basic Settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#programming-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Instructions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging Instructions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-hex-to-rom-initialization-code" class="md-nav__link">
    <span class="md-ellipsis">
      Converting .hex to ROM Initialization Code
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="arm-programming-guide">ARM Programming Guide</h1>
<p>Keil MDK is an IDE for ARM assembly/C programming and simulation. The lite version (with 32K code/debug limit and nag-screen) is available for free. You can download it on ARM website.</p>
<p>Note : The latest version is Keil MDK 5. However, you will need to install the legacy support for ARM7 which we are going to use in this module. It is easier to go with Keil MDK 4.</p>
<p>We will be using Keil MDK 4 as it comes with a built in simulator* for many ARM based cores. This allows you to test your programs before you run it on the processor YOU made. We will be using ARM7 (a <em>microarchitecture</em> executing ARMv3 <em>instruction set</em>, not to be confused with ARMv7A/M/R instruction set architecture) in this module, which is somewhat similar to the ARM Cortex M3/M4 you used in LPC1769/STM32L4 (executing ARMv7M) at an assembly level but very different at the machine language level. There are some very significant differences though, which we will see as we go along.</p>
<p>*Note that the STM32 / LPCXpresso IDE you used in EE2028/CG2028/EE2024 do not have a simulator - to test a program, you needed a microprocessor board.</p>
<h3 id="creating-a-project-and-basic-settings">Creating a Project and Basic Settings</h3>
<ul>
<li>To create a new project, Project &gt; New uVision project. Select a location (preferably an empty folder) and give a name (which will be the same as the name of the Hex file generated by the IDE, so remember the name you gave and the location).</li>
<li>You will get a device selection screen. Expand ARM and choose ARM7 (Little Endian).</li>
<li>On the project pane on the left, expand 'Target 1' &gt; right-click on Source Group 1. Select 'Add files to Group Source Group 1'.</li>
<li>In the file selection window that comes up, in the drop-down list, change 'Files of type' to 'Asm Source file (*.s*, *.src, *.a*)'. Browse to the folder containing the assembly language source (.s) file and click 'Add'. Click 'Close' to dismiss the window (it won't disappear even after you select a file).</li>
<li>Use this sample assembly language program - <a href="https://github.com/NUS-CG3207/lab-skeletons/blob/main/lab1/arm_assembly_sample.s">ARM_sample.s</a>. <strong>Please read the instructions in the comments carefully</strong>. The example code will produce this error when you execute the instruction in line 39 (line 30 in the older version) - <em>error 65: access violation at 0x00000804 : no 'write' permission</em>. However, this does not cause any problem in real hardware - say, if you try this code on the processor you will be designing in Lab 2. Why?</li>
<li>Screenshots illustrating settings are given below. To bring up the window : Project -&gt; Options for Target 'Target 1'. Note that the correct window might come up only on the second try - thanks to the wonderful (sarcasm intended) Keil UI.</li>
<li>Use this file <a href="https://github.com/NUS-CG3207/lab-skeletons/blob/main/lab1/MMIO.ini">MMIO.ini</a> in Project -&gt; Options for Target -&gt; Debug -&gt; Initialisation file (see the screenshot below).</li>
</ul>
<p><img alt="" src="../arm_option_target1.png" /></p>
<p><img alt="" src="../arm_option_target2.png" /></p>
<p><img alt="" src="../arm_option_target3.png" /></p>
<p><img alt="" src="../arm_option_target4.png" /></p>
<p>*See bullet 7 above</p>
<p><img alt="" src="../arm_option_target5.png" /></p>
<p><img alt="" src="../arm_option_target6.png" /></p>
<p><strong>Figure 1(a)-1(f)</strong> : Project &gt; Options for Target '<target\_name>'</p>
<ul>
<li>Please note that syntax highlighting might not work properly for some keywords.</li>
</ul>
<h3 id="programming-instructions">Programming Instructions</h3>
<ul>
<li>Note that the assembler directives in Keil MDK are different from LPCXpresso IDE/GCC toolchain. <ul>
<li>For example, instead of <strong>.word</strong>, Keil uses <strong>DCD</strong> directive. </li>
<li>The assembler directives can be found <a href="http://www.keil.com/support/man/docs/armasm/armasm_dom1361290000455.htm">here</a>. </li>
<li>You might be particularly interested in DCD (.word), DSB (store bytes, for strings), SPACE (.lcomm), EQU (.equ). </li>
<li>Labels do not have a '<strong>:</strong>' following them.</li>
</ul>
</li>
<li>PC relative adressing mode (LDR Rd, LABEL) is identical to offset mode, where the base register is implicitly R15/PC (LDR Rd, [R15, #offset]). The offset is calculated automatically by the assembler, as the assembler knows the address corresponding to LABEL. Please note that in ARMv3, reading R15/PC returns the current PC+8. </li>
<li>Instructions with R15/PC as an implicit or explicit <em>source operand</em> (for example, PC relative load/source, Data processing instructions with PC as a source operand, Branch) can only use PC+8 value. However, if the R15/PC is specified as a <em>destination</em> (implicity or explicity), the result is written as such to R15/PC.  </li>
<li>DO NOT use pseudo-instructions. <ul>
<li>Instead of the pseudo-instruction LDR  R2, =variable1; use LDR R2, variable1_addr and variable1_addr DCD variable1. </li>
<li>This will allow us to have control over where exactly variable1_addr is stored in the memory, which will make things easier when we insert our program into the Instruction (code) and Data (constant) ROMs created in the FPGA (in Lab 2).</li>
<li>Keil/ARM assembler supports pseudo-instructions, but we just avoid it for the reason mentioned above.</li>
</ul>
</li>
<li>You can refer to <a href="https://canvas.nus.edu.sg/courses/62251/files/folder/Lab%20Resources?preview=4733362">ARM Architecture Reference Manual.pdf</a> to see ARMv3 instruction set architecture.</li>
</ul>
<h3 id="debugging-instructions">Debugging Instructions</h3>
<ul>
<li>
<p>To start a debug session, go to Debug &gt; Start/Stop debugging session. Debugging is done similar to how it is done in almost all IDEs. You can the see instruction in Hex, inspect register and memory values etc.  </p>
</li>
<li>
<p>Make sure you do a 'Rebuild All' before you start a debug session (<img alt="" src="../arm_rebuild.png" />) every time you make some changes in code. The IDE will not even prompt you to rebuild your code. It will continue using the binary from your last build, but the code displayed is the latest. This behavior it baffling, to say the least. To avoid it, always Rebuild All before starting a debug session.  </p>
</li>
<li>
<p>Also note that when you do a CPU reset in the simulator (<img alt="" src="../arm_reset.png" />), the RAM (memory storing variables) in the simulator might not get reset.  </p>
</li>
<li>
<p>Use memory windows to see the memory contents. <img alt="" src="../arm_mem_windows.png" />. You can click and edit the memory (only regions with read-write permission) if you want to manually change memory values during debugging.</p>
</li>
</ul>
<h3 id="converting-hex-to-rom-initialization-code">Converting .hex to ROM Initialization Code</h3>
<p>Open the <a href="https://github.com/NUS-CG3207/lab-skeletons/blob/main/lab1/hex2rom.exe">Hex2ROM</a> program (requires <a href="https://www.microsoft.com/en-sg/download/confirmation.aspx?id=30679&amp;6B49FDFB-8E5B-4B07-BC31-15695C5A2143=1">VS 2012 Redistributable</a>) and navigate to the .hex file for your project, generated by Keil MDK. The program converts the .hex file into a format which can be pasted into Wrapper.vhd/v (for Lab 2) or the ROMs for Lab 1. The format to be pasted is written into the clipboard as well as to a .vhd/v file having the same name as the .hex file.  </p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>